' Gambas class file
'
' SPDX-FileCopyrightText: © 2012-2016 Michał Głowienka <eloaders@linux.pl>
' SPDX-FileCopyrightText: © 2020 Peter J. Mello <admin@petermello.net>
'
' SPDX-License-Identifier: GPL-3.0-or-later
' ------------------------------------------------------------------------------

Public pic As Picture
Public Sub Form_Open()
 If Not Exist(User.Home & "/.config/i-nex") Then
 Mkdir User.Home & "/.config/i-nex"
 Endif
 If Exist(User.Home & "/.config/i-nex/lastsaveg") Then
 ButtonBox1.Text = File.Load(User.Home & "/.config/i-nex/lastsaveg")
 Else
 ButtonBox1.Text = Desktop.Path
 Endif
  If Settings["Window/X"] = Null Then
     Me.Center
  Else
     Try Me.X = Settings["Window/X", Me.X]
     Try Me.Y = Settings["Window/Y", Me.Y]
  Endif
 PictureBox1.Picture = pic
 TextBox1.Text = Date & Time
 TextBox1.Text = Replace(TextBox1.Text, "/", "")
 TextBox1.Text = Replace(TextBox1.Text, ":", "")
 TextBox1.Text = Replace(TextBox1.Text, ".", "")
 ComboBox1.Add(".png")
 ComboBox1.Add(".jpg")
 ComboBox1.Index = 0
 SliderBox1.Value = 9

End

Public Sub Button2_Click()

 Me.Close

End

Public Sub Button1_Click()

ScreenShot.save(ButtonBox1.Text, TextBox1.Text, ComboBox1.Text, SliderBox1.Value)
File.Save(User.Home & "/.config/i-nex/lastsaveg", ButtonBox1.Text)

Form_Close()
End

Public Sub ButtonBox1_Click()

 Dialog.SelectDirectory
 Dialog.Title = "Select dir"
 ButtonBox1.Text = Dialog.Path

End

Public Sub Form_Close()

 File.Save(User.Home & "/.config/i-nex/lastsaveg", ButtonBox1.Text)
 Me.Close

End

Public Sub ComboBox1_Click()

 If ComboBox1.Text = ".png" Then
  SliderBox1.MaxValue = 10
  SliderBox1.Value = 9
 Else
  SliderBox1.MaxValue = 100
  SliderBox1.Value = 70
 Endif

End

Public Sub save(directory As String, filename As String, fileformat As String, filequality As Integer)

 Try pic.Save(directory & "/" & filename & fileformat & "", filequality)

End
